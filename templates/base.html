<!DOCTYPE html>
<html lang="es" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}La Pecera - Padel Hub{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'primary': '#1e3a8a',
                        'secondary': '#10b981',
                        'accent': '#fbbf24',
                        'dark-bg': '#0f172a',
                        'dark-card': '#1e293b',
                        'dark-border': '#334155',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        * { font-family: 'Inter', sans-serif; }
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            min-height: 100vh;
        }
    </style>
</head>
<body class="bg-dark-bg text-gray-100">

    {% if session.get('user_id') %}
    <nav class="bg-dark-card border-b border-dark-border sticky top-0 z-50 backdrop-blur-lg bg-opacity-90">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">

                <!-- Logo con Dropdown -->
                <div class="relative group">
                    <button class="flex items-center space-x-3 hover:opacity-80 transition cursor-pointer">
                        <div class="w-10 h-10 bg-gradient-to-br from-secondary to-accent rounded-lg flex items-center justify-center">
                            <span class="text-xl">üéæ</span>
                        </div>
                        <span class="text-xl font-bold bg-gradient-to-r from-secondary to-accent bg-clip-text text-transparent">
                            La Pecera
                        </span>
                        <svg class="w-4 h-4 text-gray-400 group-hover:text-gray-200 transition" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>

                    <div class="absolute left-0 mt-2 w-48 bg-dark-card border border-dark-border rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
                        {% if request.endpoint != 'dashboard' %}
                        <a href="{{ url_for('dashboard') }}" class="block px-4 py-3 text-gray-300 hover:bg-dark-bg hover:text-secondary transition rounded-t-lg">
                            <span class="mr-2">üè†</span> Inicio
                        </a>
                        {% endif %}
                        {% if request.endpoint != 'pozos' %}
                        <a href="{{ url_for('pozos') }}" class="block px-4 py-3 text-gray-300 hover:bg-dark-bg hover:text-secondary transition">
                            <span class="mr-2">üé±</span> Pozos
                        </a>
                        {% endif %}
                        {% if request.endpoint != 'estadisticas' %}
                        <a href="{{ url_for('estadisticas') }}" class="block px-4 py-3 text-gray-300 hover:bg-dark-bg hover:text-secondary transition">
                            <span class="mr-2">üìä</span> Estad√≠sticas
                        </a>
                        {% endif %}
                        {% if request.endpoint != 'ranking' %}
                        <a href="{{ url_for('ranking') }}" class="block px-4 py-3 text-gray-300 hover:bg-dark-bg hover:text-secondary transition">
                            <span class="mr-2">üèÜ</span> Ranking
                        </a>
                        {% endif %}
                        {% if session.get('is_admin') %}
                        <div class="border-t border-dark-border"></div>
                        <a href="{{ url_for('admin_panel') }}" class="block px-4 py-3 text-accent hover:bg-accent/10 transition">
                            <span class="mr-2">‚öôÔ∏è</span> Admin
                        </a>
                        {% endif %}
                    </div>
                </div>

                <!-- Bot√≥n perfil usuario (arriba derecha) -->
                <a href="{{ url_for('perfil') }}" class="flex items-center space-x-3 hover:bg-dark-bg px-3 py-2 rounded-lg transition group">
                    {% if usuario_actual and usuario_actual.foto_perfil and usuario_actual.foto_perfil != 'default.png' %}
                    <img src="{{ usuario_actual.foto_perfil }}" alt="Perfil"
                        class="w-10 h-10 rounded-full object-cover border-2 border-secondary">
                    {% else %}
                    <div class="w-10 h-10 bg-gradient-to-br from-secondary to-accent rounded-full flex items-center justify-center">
                        <span class="text-lg font-bold text-dark-bg">{{ session.user_name[0].upper() }}</span>
                    </div>
                    {% endif %}
                    <div class="hidden md:block text-right">
                        <p class="text-sm font-medium text-gray-100 group-hover:text-secondary transition">
                            {{ session.user_name }}
                        </p>
                        <p class="text-xs text-gray-400">
                            {% if session.get('is_admin') %}Administrador{% else %}Miembro{% endif %}
                        </p>
                    </div>
                </a>

            </div>
        </div>
    </nav>
    {% endif %}

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
            <div class="space-y-2">
                {% for category, message in messages %}
                <div class="p-4 rounded-lg {% if category == 'success' %}bg-green-900/50 border border-green-700 text-green-200{% else %}bg-red-900/50 border border-red-700 text-red-200{% endif %}">
                    {{ message }}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
</body>
</html>
